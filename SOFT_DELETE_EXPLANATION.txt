<!-- SOFT DELETE EXPLANATION -->
<!-- 
  SOFT DELETE adalah teknik untuk menandai data sebagai "dihapus" tanpa benar-benar 
  menghapusnya dari database. Data tetap tersimpan di database namun tersembunyi dari view normal.
  
  CARA KERJA SOFT DELETE:
  ======================
  
  1. Ada kolom 'deleted_at' di database (default NULL)
  2. Ketika data dihapus: deleted_at = timestamp (waktu penghapusan)
  3. Data tetap ada di database, tapi tidak muncul di view normal
  4. Ada menu khusus untuk lihat data yang dihapus dan restore-nya
  
  VISUAL:
  -------
  SEBELUM DELETE:
  | id | nama  | deleted_at |
  |----|-------|------------|
  | 1  | Event | NULL       | ‚Üê Muncul di view normal
  | 2  | Tiket | NULL       | ‚Üê Muncul di view normal
  
  SETELAH DELETE:
  | id | nama  | deleted_at          |
  |----|-------|---------------------|
  | 1  | Event | NULL                | ‚Üê Masih muncul
  | 2  | Tiket | 2026-01-26 10:30:45 | ‚Üê TIDAK muncul di view normal
  
  FITUR YANG DITAMBAHKAN:
  =======================
  
  1. Migrations (database schema changes):
     - 2026_01_26_000001_add_soft_deletes_to_events_table.php
     - 2026_01_26_000002_add_soft_deletes_to_tikets_table.php
     - 2026_01_26_000003_add_soft_deletes_to_kategoris_table.php
     - 2026_01_26_000004_add_soft_deletes_to_orders_table.php
  
  2. Models (dengan SoftDeletes Trait):
     - Event model
     - Tiket model
     - Kategori model
     - Order model
  
  3. Controllers (dengan restore logic):
     - KategoriController
     - EventsController
     - TiketController
     - HistoryController
  
  4. Routes (restore endpoints):
     - POST /admin/categories/{id}/restore
     - POST /admin/events/{id}/restore
     - POST /admin/tickets/{id}/restore
     - POST /admin/histories/{id}/restore
-->

==============================================================================
PENJELASAN DETAIL SOFT DELETE DI PROJECT INI
==============================================================================

üîç CARA MEMBACANYA DI DATABASE:
=====================================

Sebelum soft delete:
```sql
SELECT * FROM events;
```
Output:
```
| id | judul     | kategori_id | user_id | tanggal | lokasi | gambar | deleted_at |
|----|-----------|-------------|---------|--------|--------|--------|------------|
| 1  | Konser XY | 1           | 1       | ...    | ...    | ...    | NULL       | ‚úÖ Muncul
| 2  | Pameran Z | 2           | 1       | ...    | ...    | ...    | NULL       | ‚úÖ Muncul
```

Setelah delete event 2:
```sql
UPDATE events SET deleted_at = '2026-01-26 10:30:45' WHERE id = 2;
```
Output normal query:
```sql
SELECT * FROM events WHERE deleted_at IS NULL;
```
```
| id | judul     | kategori_id | user_id | tanggal | lokasi | gambar | deleted_at |
|----|-----------|-------------|---------|--------|--------|--------|------------|
| 1  | Konser XY | 1           | 1       | ...    | ...    | ...    | NULL       | ‚úÖ Hanya ini
```

Lihat data yang dihapus:
```sql
SELECT * FROM events WHERE deleted_at IS NOT NULL;
```
```
| id | judul     | kategori_id | user_id | tanggal | lokasi | gambar | deleted_at          |
|----|-----------|-------------|---------|--------|--------|--------|---------------------|
| 2  | Pameran Z | 2           | 1       | ...    | ...    | ...    | 2026-01-26 10:30:45 | üóëÔ∏è Data dihapus
```


üìù CARA MEMBACANYA DI CODE:
============================

1Ô∏è‚É£ DI MODELS (app/Models/Event.php):
   ```php
   use Illuminate\Database\Eloquent\SoftDeletes;

   class Event extends Model
   {
       use HasFactory, SoftDeletes;
       // ‚Üë Trait ini membuat model support soft delete
   }
   ```
   
   Artian: Model ini sekarang bisa menggunakan:
   - ->delete() ‚Üí soft delete (set deleted_at)
   - ->restore() ‚Üí kembalikan (set deleted_at = NULL)
   - ::onlyTrashed() ‚Üí hanya data yang dihapus
   - ::withTrashed() ‚Üí semua data (termasuk yang dihapus)

2Ô∏è‚É£ DI CONTROLLER (app/Http/Controllers/EventsController.php):
   
   ‚ùå SEBELUM (hapus langsung):
   ```php
   public function index()
   {
       $events = Event::all();  // Semua data + data dihapus
   }
   ```
   
   ‚úÖ SESUDAH (exclude soft deleted):
   ```php
   public function index()
   {
       // Ambil data yang BELUM dihapus (deleted_at IS NULL)
       $events = Event::whereNull('deleted_at')->with('kategori')->get();
       
       // Ambil data yang SUDAH dihapus (untuk ditampilkan di tab Trash)
       $deletedEvents = Event::onlyTrashed()->with('kategori')->get();
       
       return view('events.events', compact('events', 'deletedEvents'));
   }
   
   public function destroy(string $id)
   {
       $event = Event::findOrFail($id);
       $event->delete();  // SOFT DELETE: set deleted_at = now()
       return redirect()->route('admin.events.index')->with('success', 'Event berhasil dihapus.');
   }
   
   public function restore(string $id)
   {
       $event = Event::onlyTrashed()->findOrFail($id);  // Cari di data dihapus
       $event->restore();  // RESTORE: set deleted_at = NULL
       return redirect()->route('admin.events.index')->with('success', 'Event berhasil dipulihkan.');
   }
   ```

3Ô∏è‚É£ DI ROUTES (routes/web.php):
   ```php
   Route::resource('events', EventsController::class);
   Route::post('/events/{id}/restore', [EventsController::class, 'restore'])->name('events.restore');
   //                                ‚Üë Endpoint untuk restore
   ```

4Ô∏è‚É£ DI VIEWS (Blade template):
   ```blade
   <!-- Tab data aktif -->
   <h2>Event Aktif</h2>
   @foreach($events as $event)
       <div>
           {{ $event->judul }}
           <button onclick="deleteEvent({{ $event->id }})">Hapus</button>
       </div>
   @endforeach
   
   <!-- Tab data dihapus/Trash -->
   <h2>Event Dihapus</h2>
   @foreach($deletedEvents as $event)
       <div>
           {{ $event->judul }} (dihapus: {{ $event->deleted_at }})
           <button onclick="restoreEvent({{ $event->id }})">Pulihkan</button>
       </div>
   @endforeach
   
   <!-- Form delete -->
   <form id="deleteForm" method="POST">
       @csrf
       @method('DELETE')
   </form>
   
   <script>
       function deleteEvent(id) {
           document.getElementById('deleteForm').action = `/admin/events/${id}`;
           document.getElementById('deleteForm').submit();  // DELETE /admin/events/1
       }
       
       function restoreEvent(id) {
           // POST /admin/events/1/restore
           fetch(`/admin/events/${id}/restore`, {
               method: 'POST',
               headers: { 'X-CSRF-TOKEN': document.querySelector('meta[name="csrf-token"]').content }
           }).then(() => window.location.reload());
       }
   </script>
   ```


üéØ ALUR LOGIKA SOFT DELETE:
============================

AKSI: User klik tombol DELETE pada Event

FLOW DELETE:
  ‚îå‚îÄ User klik tombol Delete Event ID 1
  ‚îÇ
  ‚îú‚îÄ Submit form DELETE ke /admin/events/1
  ‚îÇ
  ‚îú‚îÄ EventsController::destroy(1) dipanggil
  ‚îÇ
  ‚îú‚îÄ $event = Event::findOrFail(1)  // Cari event
  ‚îÇ
  ‚îú‚îÄ $event->delete()  // Soft delete:
  ‚îÇ                    // UPDATE events SET deleted_at = NOW() WHERE id = 1
  ‚îÇ
  ‚îî‚îÄ Redirect ke admin.events.index dengan success message
                     ‚Üì
        HASIL DI DATABASE:
        | id | judul  | deleted_at          |
        |----|--------|---------------------|
        | 1  | Konser | 2026-01-26 10:30:45 | ‚Üê Masih ada tapi "dihapus"


FLOW RESTORE:
  ‚îå‚îÄ Admin klik tombol Pulihkan pada Event Dihapus
  ‚îÇ
  ‚îú‚îÄ Submit form POST ke /admin/events/1/restore
  ‚îÇ
  ‚îú‚îÄ EventsController::restore(1) dipanggil
  ‚îÇ
  ‚îú‚îÄ $event = Event::onlyTrashed()->findOrFail(1)  // Cari di trash
  ‚îÇ
  ‚îú‚îÄ $event->restore()  // Restore:
  ‚îÇ                     // UPDATE events SET deleted_at = NULL WHERE id = 1
  ‚îÇ
  ‚îî‚îÄ Redirect ke admin.events.index dengan success message
                     ‚Üì
        HASIL DI DATABASE:
        | id | judul  | deleted_at |
        |----|--------|------------|
        | 1  | Konser | NULL       | ‚Üê Kembali normal


‚ú® KEUNTUNGAN SOFT DELETE:
===========================

1. üîÑ DATA REVERSIBLE
   - Bisa dipulihkan kapan saja
   - Tidak ada permanent loss
   
2. üîç AUDIT TRAIL
   - Tahu siapa yang hapus apa kapan
   - Bisa track deleted_at
   
3. üîó RELASI TETAP AMAN
   - Foreign key tidak rusak
   - Data related tetap konsisten
   
4. üõ°Ô∏è COMPLIANCE
   - Memenuhi requirement audit/legal
   - Data history tersimpan
   
5. üíæ GARBAGE COLLECTION
   - Bisa permanent delete nanti (via cron job)
   - Atau keep forever untuk compliance


‚öôÔ∏è UNTUK MENJALANKAN MIGRATIONS:
=================================

Di terminal, jalankan:
```bash
php artisan migrate
```

Ini akan:
1. Membuat kolom deleted_at di tables: events, tikets, kategoris, orders
2. Set default value NULL untuk semua existing records
3. Soft delete siap digunakan!


üîß CUSTOMIZATION (Optional):
============================

Jika ingin tambah info "siapa yang delete":
1. Tambah kolom deleted_by di migration
2. Update middleware untuk track user ID
3. Update soft delete di model

Jika ingin permanent delete (force delete):
```php
$event->forceDelete();  // Benar-benar hapus dari database
```

Jika ingin lihat semua termasuk dihapus:
```php
$events = Event::withTrashed()->get();
```

==============================================================================
END OF SOFT DELETE EXPLANATION
==============================================================================
